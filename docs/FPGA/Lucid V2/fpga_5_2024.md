---
layout: default
permalink: /fpga/fpga_5_2024
title: LucidV2 Syntax Cheatsheet 
description: Tips on how to use code in LucidV2 and some shortcuts
parent: Lucid V2
grand_parent: 1D&2D Project (FPGA)
nav_order:  5
---


* TOC
{:toc}

**50.002 Computation Structures**
<br>
Information Systems Technology and Design
<br>
Singapore University of Technology and Design


## LucidV2 Syntax Cheatsheet


### Instantiating modules in an array with parameters

Suppose we have the following module:

```verilog
module adder #(
    SIZE = 32 : SIZE > 1
)(
    input a[SIZE],
    input b[SIZE],
    output out[SIZE],
    output z,
    output v,
    output n
  )
```

If we want to instantiate an array of 8 adders, the parameter dimension must match:

```verilog
    adder adder[8](#SIZE(8x{{16}}))
```

All modules in the array must have <span class="orange-bold">identically</span> sized ports. The following cannot be done:

```verilog
    adder adder[8](#SIZE({8d1, 8d2, 8d3, 8d4, 8d5, 8d6, 8d7, 8d8}))
```

The above will cause the first adder to have an output port `out[8]`, the second adder to have an output port `out[7]`, and so on (same with port `a` and `b`) which is **not allowed**. 

You also cannot instantiate a parameter array using constants as such:

```verilog
    const ADDER_SIZE = 16
    adder adder[8](#SIZE(8x{{ADDER_SIZE}}))
```

This is because the width of constants is flexible. We <span class="orange-bold">cannot</span> create an array in HDL with elements of varying size.  

To fix this, use the `$resize()` function:

<img src="{{ site.baseurl }}//docs/FPGA/Lucid%20V2/images/fpga_5_2024/2025-01-31-07-40-57.png"  class="center_full"/>

```verilog
    const ADDER_SIZE = 16
    adder adder[8](#SIZE(8x{{$resize(ADDER_SIZE,16)}}))
```

The "16" does not refer to 16 bits, but to match the width of **const 16** (4 bits).

### Array Manipulation 

If you instantiate a module as such as an array:
```verilog
module adder #(
    SIZE = 32 : SIZE > 1
)(
    input a[SIZE],
    input b[SIZE],
    output out[SIZE],
    output z,
    output v,
    output n
  )
```


```verilog
    const ADDER_SIZE = 16
    adder adder[8](#SIZE(8x{{$resize(ADDER_SIZE,16)}}))
```

The dimension of the ports changes too. For instance, this results in an error:

```verilog
    adder.a = 0
```

This is because the `.a` port is now expecting an 8 by 16 array. A correct way to set it is as such:

```verilog
    adder.a = 8x{{16b0}}
    adder.b = {16d0, 16d1, 16d2, 16d3, 16d4, 16d5, 16d6, 16d7}
```

You can also use array **concatenation** if that suits your use case:

```verilog
    adder_array.a = 8x{{16b0}}
    adder_array.b = c{{16d3, 16d4, 16d5, 16d6, 16d7}, 3x{{16b0}}}
```
